## Фильтрация данных с RGB и инфракрасной камер

### Данные: 
Парные снимки с двух камер - RGB и инфракрасной (одна сцена = два изображения), для каждого снимка есть маска объектов (маски создавались на основе пары снимков). Некоторые RGB снимки получены с засветами (не видно некоторых / всех объектов, которые есть на маске).

### Задача: 
1. отфильтровать данные (найти несоответствия в парах [снимок, маска]). То есть если на RGB снимке есть засвет и замечено m объектов, а на маске n объектов и n > m, то такой снимок следует извлечь из выборки
2. выбрать наиболее подходящую для оценки решения задачи метрику качества

### Решение:
1. Так как засветы есть только на RGB снимках, решено рассматривать непосредственно их
2. С помощью предварительно обученной модели производился подсчет объектов на снимках. Те снимки, на которых было найдено сильно меньше объектов, чем на маске - считались с наличием вспышки
3. В качестве метрики качества были выбраны precision (1й приоритет максимизации - т.к. необходимо снизить количество ложноположительных решений) и recall (2й приоритет максимизации - все же необходимо найти как можно больше снимков со вспышками)
4. Необходимые для описанных метрик реальные метки были найдены следующим путем - для каждого снимка было рассчитано соотношение белых пикселей ко всем пикселям. Если соотношение превосходит выбранный порог - вспышка на снимке есть

### Параметры:
1. Порог для определения количества объектов на снимке был выбран экспериментальным путем (те сущности, в которых модель уверена на 60%, считались объектами)
2. Порог для определения наличия вспышки на снимке (ориентир на соотношение белых пикселей ко всем пикселям) - flash_threshold
3. Порог для определения наличия вспышки на снимке (ориентир на разницу в количестве объектов между снимком и маской) - vehicle_threshold

### Эксперименты:
1. flash_threshold = 0.15, vehicle_threshold = 0.5: precision = 0.52, recall = 0.20 (вероятно большое количество снимков со вспышкой пропускается из-за высокого flash_threshold)
2. flash_threshold = 0.05, vehicle_threshold = 0.5: precision = 0.67, recall = 0.38 (слишком много ложноотрицательных решений из-за низкого flash_threshold, вероятно стоит понизить vehicle_threshold)
3. flash_threshold = 0.10, vehicle_threshold = 0.4: precision = 0.52, recall = 0.20

### Результаты:
Маска, соответствующая снимку с RGB камеры, на котором обнаружена вспышка, относится к снимку с инфракрасной камеры. Если вспышка не обнаружена, маска, вероятно, относится к обоим снимкам пары [RGB снимок, инфракрасный снимок].

Разумеется генерации предсказанных и "реальных" меток можно поменять местами.
